# 위니브 월드 - 다음 업데이트 작업 목록

## 우선순위 1: 긴급 수정 (1-2주)

### 버그 수정
- [ ] **JSON 직렬화/역직렬화 안정화**
  - 좌표 키를 문자열로 변환 시 공백, 실수형 처리 개선
  - 파일 위치: `script.py` line 407-410, 496-499

- [ ] **메모리 누수 해결**
  - 캐릭터 삭제 시 말풍선(speech bubble) 정리
  - setTimeout 콜백 정리 로직 추가
  - 파일 위치: `character.py` line 162-163

- [ ] **경쟁 상태(Race Condition) 방지**
  - 맵 초기화 중 사용자 액션 차단
  - 로딩 상태 표시 추가

### 사용자 경험
- [ ] **디버깅 로그 제거**
  - `script.py`의 `handle_contextmenu_delete` 함수에서 console.log 제거

---

## 우선순위 2: 단기 개선 (1개월)

### 코드 구조 개선
- [ ] **script.py 리팩토링**
  - 현재 1200줄 이상의 단일 파일을 모듈로 분리
  - 제안 구조:
    - `event_handlers.py`: 이벤트 처리
    - `ui_manager.py`: UI 업데이트
    - `game_logic.py`: 게임 로직
    - `game_state.py`: 상태 관리

- [ ] **전역 변수 중앙화**
  - GameState 클래스 도입
  - coordinate.py의 분산된 데이터를 단일 상태 객체로 관리

- [ ] **Character/Mob 클래스 공통화**
  - 중복 코드 300줄 이상 제거
  - GameEntity 기본 클래스 생성

### 성능 최적화
- [ ] **DOM 캐싱 구현**
  - 반복적인 `querySelectorAll` 호출 최소화
  - 좌표-인덱스 매핑 캐시 구현

- [ ] **마우스 이벤트 throttling**
  - `show_tooltip` 함수 최적화
  - 50ms 단위 throttle 적용

### UX 개선
- [ ] **오류 메시지 개선**
  - 영어/한글 혼용 → 한글 통일
  - 오류 해결 힌트 제공
  - 예시 코드 포함

- [ ] **로딩 인디케이터 추가**
  - 맵 로드/초기화 시 스피너 표시
  - 스토리 채점 중 진행 상황 표시

---

## 우선순위 3: 중기 기능 추가 (2-3개월)

### 학습 기능 강화
- [ ] **진행률 대시보드**
  - 전체 완료율 표시
  - 챕터별 진행 상황
  - 학습 통계 (자주 사용하는 함수, 평균 문제 풀이 시간 등)

- [ ] **힌트 시스템**
  - 점진적 힌트 제공 (3단계)
  - 문제별 맞춤 힌트

- [ ] **실시간 코드 피드백**
  - 코드 작성 중 문법 오류 표시
  - 스타일 제안

### 게임 기능 확장
- [ ] **다중 캐릭터 시스템 개선**
  - 현재 licat만 완전 지원 → 모든 캐릭터 지원
  - 활성 캐릭터 전환 기능

- [ ] **사용자 맵 저장/불러오기**
  - 커스텀 맵 로컬 저장
  - 맵 이름 지정

- [ ] **Undo/Redo 기능**
  - 아이템/몹/벽 배치 실행 취소
  - 히스토리 관리

### 접근성 개선
- [ ] **키보드 네비게이션**
  - 방향키로 캐릭터 이동
  - Tab으로 UI 요소 탐색
  - 키보드 단축키 도움말 (`?` 키)

- [ ] **스크린 리더 지원 강화**
  - 모든 상호작용 요소에 ARIA 레이블 추가
  - 게임 상태 음성 안내

- [ ] **색상 대비 개선**
  - WCAG AA 기준 충족
  - 고대비 모드 옵션

---

## 우선순위 4: 장기 기능 (3-6개월)

### 커뮤니티 기능
- [ ] **솔루션 공유**
  - 문제별 다른 사람의 솔루션 보기
  - 좋아요/댓글 기능

- [ ] **리더보드**
  - 최단 코드 솔루션
  - 가장 빠른 풀이 시간

- [ ] **맵 공유**
  - 사용자 생성 맵 공유
  - 맵 갤러리

### 고급 기능
- [ ] **NPC 상호작용 시스템**
  - NPC와 대화
  - 아이템 교환
  - 퀘스트 시스템

- [ ] **고급 맵 에디터**
  - 드래그 앤 드롭 인터페이스
  - 맵 미리보기
  - 맵 검증 기능

- [ ] **실시간 협업**
  - 멀티플레이어 지원
  - 실시간 맵 공동 편집

---

## 기술 부채 해결

### 코드 품질
- [ ] 타입 힌트 추가 (Python 3.9+)
- [ ] 단위 테스트 작성
- [ ] 코드 문서화 (docstring)
- [ ] 린터 설정 (pylint/flake8)

### 데이터 검증
- [ ] 입력 데이터 유효성 검사 강화
- [ ] 좌표 범위 검증 통일
- [ ] 방향값 오버플로우 처리

---

## 개선된 아키텍처 제안

```
assets/py/
├── game.py              # 메인 게임 클래스
├── game_state.py        # 중앙 상태 관리
├── event_handlers.py    # 이벤트 핸들러
├── ui_manager.py        # UI 관리
├── models/
│   ├── base.py          # GameEntity 기본 클래스
│   ├── character.py     # 캐릭터 클래스
│   ├── mob.py           # 몹 클래스
│   ├── item.py          # 아이템 클래스
│   └── wall.py          # 벽 클래스
├── utils/
│   ├── serializer.py    # 데이터 직렬화
│   ├── cache.py         # DOM/데이터 캐싱
│   └── validator.py     # 입력 검증
└── accessibility.py     # 접근성 기능
```

---

## 참고 사항

- 각 작업은 독립적으로 진행 가능하도록 설계
- 기존 기능에 영향을 주지 않도록 점진적 개선 권장
- 주요 변경 시 백업 필수
